<!DOCTYPE html>
<html>
    <head>
        <title>みんなでおでんき管理用</title>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
        <!--<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>-->
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
        <script src="../js/jquery.json-2.3.min.js"></script>
        <link rel="stylesheet" href="../css/odenki-theme.min.css" />
        <!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css" />-->
        <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css"/>
    </head>
    <body>
        <div data-role="page"　id="pageTop">
            <div data-role="header" data-position="inline" data-theme="e" >
                <h1><img width="40px" height="40px" src="https://twimg0-a.akamaihd.net/profile_images/1522990803/___________reasonably_small.png"></img> みんなでおでんき管理用 <img width="40px" height="40px" src="https://twimg0-a.akamaihd.net/profile_images/1522990803/___________reasonably_small.png"></img></h1>
            </div>
            <div data-role="collapsible" id="echo">
         		<h1>echoチェック （サーバに対する死活確認）取得時刻<span class="time">なし</span></h1>
       	    	<div><pre>なし</pre></div>
            </div>
			<script>
				function onExpandEcho(){
					$("#echo .time").text(new Date());
			   		$.ajax({
						url: "/api/echo?id=1",
						dataType: "text",
						success: function(data){
							$("#echo pre").text(data);
							$("#echo pre").css("background", "palegreen");
						},
						fail: function(data){
							$("#echo pre").text(data);
							$("#echo pre").css("background", "salmon");
						}
					});
					window.setTimeout(onExpandEcho, 10000);
				}
				$("#echo").bind("expand", onExpandEcho);
			</script>
			<div data-role="collapsible" id="rawData">
				<h1>RawData 取得時刻<span class="time">なし</span></h1>
				<div><pre></pre></div>
			</div>
			<script>
				function onExpandRawData(){
					$("#rawData .time").text(new Date());
					$.ajax({
						url: "/record/RawData",
						dataType: "text",
						success: function(data){
							$("#rawData pre").text(data);
							$("#rawData pre").css("background", "palegreen");
						},
						fail: function(data){
							$("#rawData pre").text(data);
							$("#rawData pre").css("background", "salmon");
						}
					});
					window.setTimeout(onExpandRawData, 10000);
				}
				$("#rawData").bind("expand", onExpandRawData);
			</script>
			<div data-role="collapsible" id="rawDataTable">
				<h1>RawData 取得時刻<span class="time">なし</span></h1>
				<div class="table"></div>
			</div>
			<script>
				function onExpandRawDataTable(){
					$("#rawDataTable .time").text(new Date());
					$.ajax({
						url: "/record/RawData?format=DataTable",
						dataType: "text",
						success: function(data){
							$("#rawDataTable .table").text(data);
						},
						fail: function(data){
							$("#rawDataTable .table").text("取得できません");
							$("#rawDataTable pre").css("background", "salmon");
						}
					});
					window.setTimeout(onExpandRawData, 10000);
				}
				$("#rawDataTable").bind("expand", onExpandRawDataTable);
			</script>
	        <div data-role="fieldcontain">
	        	<label for="versionString">バージョン</label>
	            <input name="versionString" id="versionString" size="10" data-mini="true"/>
	            <label for="timeStampString">更新日時</label>
	            <input name="timeStampString" id="timeStampString" size="10" data-mini="true"/>
	        </div>
	        <script>
			   		$.ajax({
						url: "/api/version",
						dataType: "json",
						success: function(data){
							$("#versionString").val(data.result.versionString);
							$("#timeStampString").val(data.result.timeStampString);
							//$("#version").text(data);
						}
					});
	        </script>
	        <div data-role="fieldcotains">
	        	管理者モード
	        	<select data-role="slider" id="sliderAdminMode">
	        		<option value="off">Off</option>
	        		<option value="on">On</option>
	        	</select>
        	</div>
        	<script>
        		$("#sliderAdminMode").bind("change", sliderAdminMode);
        		$("#sliderAdminMode").slider({
        			create : sliderAdminMode
        		});
        		function sliderAdminMode(event, ui){
			   		$.ajax({
						url: "/api/admin/mode?method=" + event.type + "&mode=" + ui.value,
						dataType: "json",
						success: function(data){
							if(data.error){
								event.target.slider({disabled:true});
								event.target.slider("refresh");
								return;	
							}
							if(data.result){
								event.target.slider(data.result.mode);
								event.target.slider('refresh');
								return;
							}
						},
						fail: function(data){
							// HTTP status 4xx or 5xx
						}
					});
				}
        	</script>
        </div>
        <script src="../js/dummy.js"></script>
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script>
			google.setOnLoadCallback(function(){
				//ページがロードされたあとこれが実行される
				//googleという名前空間はこの直上の jsapi でロードされる
			});
			$('#pageTop').live('pagecreate', function(){
				//ページがロードされたあとこれが実行される
			});
        </script>
        <!--
        <script type="text/javascript">
            google.load("visualization", "1", {
                packages : ["corechart", 'table']
            });
        </script>
        -->
        <!--
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyDYYXbxjq_CZePgdVU2x9AMRPsuX4PBSPE&sensor=false"></script>
        <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/tags/markermanager/1.0/src/markermanager.js"></script>
        <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer_compiled.js"></script>
        -->
    </body>
</html>